<div class="wrapper-event">
  <div class="filters">

    <div class="filter-tags">
      <label for="tagFilter">Categorías:</label>
      <select
        id="tagFilter"
        [(ngModel)]="tagToAdd"
        (change)="addTagToSelection()"
        class="tag-select"
      >
        <option value="" disabled selected>Selecciona una categoría</option>
        <option *ngFor="let tag of availableTags" [ngValue]="tag">
          {{ tag.nombre }}
        </option>
      </select>
    </div>

    <div class="filter-status">
      <label for="statusFilter">Estado:</label>
      <select
        id="statusFilter"
        [(ngModel)]="selectedStatus"
        class="status-select"
      >
        <option value="">Todos</option>
        <option *ngFor="let status of availableStatuses" [value]="status">
          {{ status }}
        </option>
      </select>
    </div>

    <div class="sort-wrapper">
      <label>Ordenar:</label>
      <button class="sort-button" (click)="toggleSortOrder()">
        Fecha {{ sortOrder === 'asc' ? '↑' : '↓' }}
      </button>
    </div>

    <button class="clear-filter" (click)="clearFilter()">Limpiar</button>

    <div class="selected-categories" *ngIf="selectedTags.length > 0">
      <div
        class="tag-chip"
        *ngFor="let tag of selectedTags"
        [ngStyle]="{'background-color': tag.color}"
      >
        {{ tag.nombre }}
        <span class="remove-tag" (click)="removeTag(tag)">×</span>
      </div>
    </div>
  </div>

  <div class="events-wrapper">
<div
  class="event-card"
  *ngFor="let event of filteredEvents"
  [ngStyle]="{'border-left': '6px solid ' + getStatusColor(event.estado)}"
>
  <div class="event-header">
    <div class="status-badge" [style.background]="getStatusColor(event.estado)">
      {{ mapEstadoDisplay[event.estado] || event.estado }}
    </div>
    <div class="actions">
      <button class="icon-button edit-button" (click)="editEvent(event.id!)">
        <span class="material-icons">edit</span>
      </button>
      <button class="icon-button delete-button" (click)="deleteEvent(event.id!)">
        <span class="material-icons">delete</span>
      </button>
    </div>
  </div>

  <h3 class="event-title">{{ event.titulo }}</h3>
  <p class="event-description">{{ event.descripcion }}</p>

  <div class="event-info">
    <p><strong>Sector:</strong> {{ event.sector.nombre }}</p>

    <div class="tags-container">
      <span
        *ngFor="let tag of event.tags"
        class="tag"
        [ngStyle]="{'background-color': tag.color}"
      >
        {{ tag.nombre }}
      </span>
    </div>

    <div class="event-results" *ngIf="event.estado === 'FINALIZADO'">
      <p><strong>Consumo:</strong> {{ event.litrosConsumidos }} litros</p>
      <p><strong>Costo:</strong> ${{ event.costo }}</p>
    </div>
  </div>

  <div class="event-footer">
    <div class="event-dates">
      <span><strong>Inicio:</strong> {{ event.fechaInicio | date:'short' }}</span>
      <span *ngIf="event.fechaFin">
        <strong>Fin:</strong> {{ event.fechaFin | date:'short' }}
      </span>
    </div>

    <div *ngIf="event.estado === 'EN_PROCESO'" class="footer-action">
      <button class="finalize-btn" (click)="finalizeEvent(event)">Finalizar</button>
    </div>

    <div *ngIf="event.estado === 'PENDIENTE'" class="footer-action">
      <button class="start-btn" (click)="startEvent(event)">Comenzar</button>
    </div>
  </div>
</div>

</div>
